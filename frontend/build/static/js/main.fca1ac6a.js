(()=>{"use strict";var e={306:(e,n,a)=>{var t=a(950),s=a(352),r=a(887),c=a(452);const o={testnet:{name:"Irys Testnet",url:"https://node2.irys.xyz",token:"ethereum",rpcUrl:"https://rpc.sepolia.org",chainId:11155111,gateway:"https://gateway.irys.xyz"},mainnet:{name:"Irys Mainnet",url:"https://node1.irys.xyz",token:"ethereum",rpcUrl:"https://eth.llamarpc.com",chainId:1,gateway:"https://gateway.irys.xyz"}};async function i(){if(!window.ethereum)return{connected:!1,error:"MetaMask not installed"};try{const e=await window.ethereum.request({method:"eth_accounts"});return e.length>0?{connected:!0,address:e[0]}:{connected:!1,error:"No accounts connected"}}catch(e){return{connected:!1,error:e.message}}}async function l(){if(!window.ethereum)throw new Error("MetaMask not installed. Please install MetaMask to connect your wallet.");try{if(0===(await window.ethereum.request({method:"eth_requestAccounts"})).length)throw new Error("No accounts found. Please check your MetaMask.");const e=new c.k(window.ethereum),n=await e.getSigner();return{connected:!0,address:await n.getAddress(),signer:n}}catch(e){if(4001===e.code)throw new Error("User rejected the connection request");throw new Error(`Failed to connect wallet: ${e.message}`)}}const d="https://irys-reflex-backend.onrender.com";var u=a(414);const m=()=>{var e,n;const[a,s]=(0,t.useState)("waiting"),[c,m]=(0,t.useState)(null),[h,f]=(0,t.useState)(!1),[y,p]=(0,t.useState)(""),[g,w]=(0,t.useState)(""),[v,x]=(0,t.useState)(!1),[j,k]=(0,t.useState)(!1),[b,N]=(0,t.useState)(null),[S,_]=(0,t.useState)(null),[T,A]=(0,t.useState)([]),[I,C]=(0,t.useState)(!1),[$,E]=(0,t.useState)(""),[O,P]=(0,t.useState)(!1),[M,R]=(0,t.useState)("classic"),[F,q]=(0,t.useState)([]),[D,U]=(0,t.useState)(0),[W,K]=(0,t.useState)([]),[L,B]=(0,t.useState)(3),[G,Y]=(0,t.useState)(0),[z,V]=(0,t.useState)(60),[J,H]=(0,t.useState)(null),[Q,X]=(0,t.useState)(0),[Z,ee]=(0,t.useState)(0),ne=(0,t.useRef)(null),ae=(0,t.useRef)(null),te=(0,t.useRef)(null),se=(0,t.useRef)(null);(0,t.useEffect)(()=>{se.current=new(window.AudioContext||window.webkitAudioContext);const e=(()=>{const e=setInterval(()=>{fetch(`${d}/api/health`).then(e=>{e.ok?console.log("\u2705 Keep-alive ping successful"):console.warn("\u26a0\ufe0f Keep-alive ping failed:",e.status)}).catch(e=>{console.warn("\u26a0\ufe0f Keep-alive ping error:",e.message)})},6e4);return console.log("\ud83d\udd04 Keep-alive service started (60s interval)"),()=>{clearInterval(e),console.log("\ud83d\uded1 Keep-alive service stopped")}})();return()=>{e&&e()}},[]),(0,t.useEffect)(()=>{re(),le(),je(),ie()},[]);const re=async()=>{try{const e=await i();e.connected&&(w(e.address),x(!0),await ce(),r.Ay.success("Wallet connected!"))}catch(e){console.error("Initial wallet check failed:",e)}},ce=async()=>{try{const e=await async function(){try{const e="https://irys-reflex-backend.onrender.com",n=await fetch(`${e}/api/irys/balance`),a=await n.json();return n.ok?{success:!0,balance:a.balance,address:a.address,network:a.network}:{success:!1,error:a.detail||"Failed to check balance"}}catch(e){return{success:!1,error:`Network error: ${e.message}`}}}();e.success?N(e.balance):console.error("Balance check failed:",e.error)}catch(e){console.error("Balance check error:",e)}},oe=async()=>{try{r.Ay.loading("Funding account...",{id:"funding"});const n=await async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e4;try{const n="https://irys-reflex-backend.onrender.com",a=await fetch(`${n}/api/irys/fund`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:e})}),t=await a.json();return a.ok?{success:!0,transaction:t.transaction,amount:t.amount,message:t.message}:{success:!1,error:t.detail||"Funding failed",needsFaucet:402===a.status}}catch(n){return{success:!1,error:`Network error: ${n.message}`}}}(1e4);var e;if(n.success)r.Ay.success(n.message,{id:"funding"}),await ce();else if(n.needsFaucet)r.Ay.error("Please get testnet tokens from the faucet first",{id:"funding"}),null!==S&&void 0!==S&&null!==(e=S.config)&&void 0!==e&&e.faucet_url&&window.open(S.config.faucet_url,"_blank");else r.Ay.error(n.error,{id:"funding"})}catch(n){r.Ay.error("Funding failed: "+n.message,{id:"funding"})}},ie=async()=>{try{const e=await async function(){try{const e="https://irys-reflex-backend.onrender.com",n=await fetch(`${e}/api/irys/network-info`),a=await n.json();return n.ok?{success:!0,network:a.network,config:a.config,account:a.account,clientStatus:a.client_status}:{success:!1,error:"Failed to get network info"}}catch(e){return{success:!1,error:`Network error: ${e.message}`}}}();e.success&&_(e)}catch(e){console.error("Failed to fetch network info:",e)}},le=async()=>{try{const e=await fetch("https://irys-reflex-backend.onrender.com/api/game-modes");if(e.ok){const n=await e.json();q(n.modes)}}catch(e){console.error("Error fetching game modes:",e)}},de=()=>{if(!se.current)return;const e=se.current,n=e.createOscillator(),a=e.createGain();n.connect(a),a.connect(e.destination),n.frequency.value=800,n.type="sine",a.gain.setValueAtTime(.1,e.currentTime),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.05),n.start(e.currentTime),n.stop(e.currentTime+.05)},ue=()=>{if(y.trim())switch(s("ready"),f(!1),m(null),P(!0),U(0),K([]),Y(0),V(60),X(0),ee(0),M){case"classic":default:me();break;case"sequence":he();break;case"endurance":fe();break;case"precision":ye()}else r.Ay.error("Please enter a username before starting the game!")},me=()=>{const e=4e3*Math.random()+1e3;te.current=setTimeout(()=>{s("flashed"),ae.current=Date.now(),de()},e)},he=()=>{U(0),K([]);const e=2e3*Math.random()+1e3;te.current=setTimeout(()=>{s("flashed"),ae.current=Date.now(),de()},e)},fe=()=>{Y(0),V(60);const e=setInterval(()=>{V(n=>n<=1?(clearInterval(e),s("finished"),m(G),0):n-1)},1e3);H(e);const n=2e3*Math.random()+500;te.current=setTimeout(()=>{s("flashed"),ae.current=Date.now(),de()},n)},ye=()=>{X(0),ee(0);const e=3e3*Math.random()+1500;te.current=setTimeout(()=>{s("flashed"),ae.current=Date.now(),de()},e)},pe=e=>{switch(M){case"classic":default:ge(e);break;case"sequence":we(e);break;case"endurance":ve(e);break;case"precision":xe(e)}},ge=e=>{m(e),s("finished")},we=e=>{const n=[...W,e];if(K(n),n.length>=L){const e=Math.round(n.reduce((e,n)=>e+n,0)/n.length);m(e),s("finished")}else{U(n.length),s("ready");const e=1500*Math.random()+500;te.current=setTimeout(()=>{s("flashed"),ae.current=Date.now(),de()},e)}},ve=e=>{Y(e=>e+1),s("ready");const n=1500*Math.random()+300;te.current=setTimeout(()=>{z>0&&(s("flashed"),ae.current=Date.now(),de())},n)},xe=e=>{ee(e=>e+1),m(e),s("finished")},je=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;try{const n=e||M,a="https://irys-reflex-backend.onrender.com/api/leaderboard"+(n?`?game_mode=${n}`:""),t=await fetch(a);if(t.ok){const e=await t.json();A(e)}}catch(n){console.error("Error fetching leaderboard:",n)}},ke=e=>{const n=F.find(n=>n.id===e);return n?n.name:e};return(0,t.useEffect)(()=>{M&&je(M)},[M]),(0,u.jsxs)("div",{className:"app",children:[(0,u.jsx)(r.l$,{position:"top-center",toastOptions:{duration:4e3,style:{background:"rgba(255, 255, 255, 0.1)",color:"#F8F8FF",border:"1px solid rgba(0, 255, 209, 0.3)",backdropFilter:"blur(10px)"}}}),(0,u.jsxs)("div",{className:"container",children:[(0,u.jsxs)("header",{className:"header",children:[(0,u.jsxs)("h1",{className:"title",children:[(0,u.jsx)("span",{className:"irys-gradient",children:"Irys"})," Reflex"]}),(0,u.jsx)("p",{className:"subtitle",children:"Test Your Reaction Time on the Blockchain"})]}),(0,u.jsx)("div",{className:"wallet-section",children:v?(0,u.jsxs)("div",{className:"wallet-connected",children:[(0,u.jsxs)("div",{className:"wallet-info",children:[(0,u.jsxs)("div",{className:"wallet-address",children:[(0,u.jsx)("strong",{children:"\u2705 Wallet Connected:"}),(0,u.jsxs)("span",{className:"address",children:[g.slice(0,6),"...",g.slice(-4)]})]}),(0,u.jsxs)("div",{className:"irys-balance",children:[(0,u.jsx)("strong",{children:"Irys Balance:"}),(0,u.jsx)("span",{className:"balance",children:null!==b?`${b} wei`:"Loading..."}),null!==b&&b<1e3&&(0,u.jsx)("button",{onClick:oe,className:"fund-btn",title:"Fund your account to save scores",children:"\ud83d\udcb0 Fund Account"})]}),S&&(0,u.jsxs)("div",{className:"network-info",children:[(0,u.jsx)("strong",{children:"Network:"}),(0,u.jsxs)("span",{children:[S.network," (",null===(e=S.config)||void 0===e?void 0:e.name,")"]}),(null===(n=S.config)||void 0===n?void 0:n.faucet_url)&&(0,u.jsx)("a",{href:S.config.faucet_url,target:"_blank",rel:"noopener noreferrer",className:"faucet-link",children:"\ud83d\udeb0 Get Testnet Tokens"})]})]}),(0,u.jsx)("div",{className:"username-section",children:(0,u.jsx)("input",{type:"text",placeholder:"Enter your username",value:y,onChange:e=>p(e.target.value),className:"username-input",maxLength:20})})]}):(0,u.jsxs)("div",{className:"wallet-connect",children:[(0,u.jsxs)("div",{className:"wallet-status",children:[(0,u.jsx)("h3",{children:"\ud83d\udd17 Connect Your Wallet"}),(0,u.jsx)("p",{children:"Connect MetaMask to save your scores permanently on Irys blockchain"})]}),(0,u.jsx)("button",{onClick:async()=>{if(!j){k(!0);try{const e=await l();w(e.address),x(!0),await ce(),r.Ay.success("Wallet connected successfully!")}catch(e){console.error("Wallet connection failed:",e),r.Ay.error(e.message||"Failed to connect wallet")}finally{k(!1)}}},disabled:j,className:"connect-wallet-btn",children:j?"\ud83d\udd04 Connecting...":"\ud83e\udd8a Connect MetaMask"}),!window.ethereum&&(0,u.jsx)("div",{className:"metamask-warning",children:(0,u.jsxs)("p",{children:["\u26a0\ufe0f MetaMask not detected. ",(0,u.jsx)("a",{href:"https://metamask.io",target:"_blank",rel:"noopener noreferrer",children:"Install MetaMask"})]})})]})}),(0,u.jsxs)("div",{className:"game-mode-section",children:[(0,u.jsx)("h3",{className:"game-mode-title",children:"Select Game Mode"}),(0,u.jsx)("div",{className:"game-mode-grid",children:Array.isArray(F)&&F.length?F.map(e=>(0,u.jsxs)("div",{className:"game-mode-card "+(M===e.id?"selected":""),onClick:()=>R(e.id),children:[(0,u.jsx)("div",{className:"game-mode-icon",children:e.icon}),(0,u.jsx)("div",{className:"game-mode-name",children:e.name}),(0,u.jsx)("div",{className:"game-mode-description",children:e.description})]},e.id)):(0,u.jsx)("p",{children:"No game modes available"})})]}),(0,u.jsxs)("div",{className:"game-section",children:[(0,u.jsx)("div",{className:"game-container",children:(0,u.jsxs)("div",{ref:ne,className:`game-circle ${"flashed"===a?"flashed":""} ${"ready"===a?"ready":""} ${"precision"===M?"precision":""}`,onClick:()=>{if("ready"===a)f(!0),m(500),s("finished"),te.current&&clearTimeout(te.current),J&&clearInterval(J);else if("flashed"===a){const e=Date.now()-(ae.current||0);pe(e)}},children:["waiting"===a&&(0,u.jsxs)("span",{children:["Click to Start",(0,u.jsx)("br",{}),(0,u.jsxs)("small",{children:[ke(M)," Mode"]})]}),"ready"===a&&(0,u.jsxs)("span",{children:["sequence"===M&&`Target ${D+1}/${L}`,(0,u.jsx)("br",{}),"endurance"===M&&`${z}s | ${G} hits`,(0,u.jsx)("br",{}),"Wait for flash..."]}),"flashed"===a&&(0,u.jsx)("span",{children:"CLICK NOW!"}),"finished"===a&&(0,u.jsxs)("span",{children:[h?"Too Soon!":"endurance"===M?"Time Up!":"Good!",(0,u.jsx)("br",{}),(()=>{if("endurance"===M)return`${G} hits`;if("sequence"===M)return`${c}ms avg (${W.length}/${L})`;if("precision"===M){return`${c}ms (${(Z/(Z+Q)*100).toFixed(1)}% accuracy)`}return h?`${c}ms (+ 500ms penalty)`:`${c}ms`})()]})]})}),(0,u.jsxs)("div",{className:"controls",children:["waiting"===a&&(0,u.jsx)("button",{onClick:ue,className:"start-btn",children:"Start Game"}),"finished"===a&&(0,u.jsxs)("div",{className:"finished-controls",children:[(0,u.jsx)("button",{onClick:ue,className:"restart-btn",children:"Play Again"}),(0,u.jsx)("button",{onClick:()=>{s("waiting"),P(!1),f(!1),m(null),E(""),U(0),K([]),Y(0),V(60),X(0),ee(0),te.current&&clearTimeout(te.current),J&&clearInterval(J)},className:"reset-btn",children:"Reset"}),g&&(0,u.jsx)("button",{onClick:async()=>{if(!y.trim())return void r.Ay.error("Please enter a username");if(!v||!g)return void r.Ay.error("Please connect your wallet first");if(null===c&&"endurance"!==M)return void r.Ay.error("No reaction time recorded");if(!("testnet"===(null===S||void 0===S?void 0:S.network)||"devnet"===(null===S||void 0===S?void 0:S.network))&&null!==b&&b<1e3)r.Ay.error("Insufficient balance. Please fund your account with IRYS tokens.",{duration:6e3,action:{label:"Fund Account",onClick:oe}});else{C(!0);try{const e={player:g,username:y.trim(),time:c,penalty:h,timestamp:Date.now(),game_mode:M};"sequence"===M?(e.sequence_times=W,e.total_targets=L):"endurance"===M?(e.hits_count=G,e.time=G):"precision"===M&&(e.accuracy=Z/(Z+Q)*100,e.total_targets=Z+Q),r.Ay.loading("Uploading to Irys blockchain...",{id:"upload"});const n=await async function(e){try{const n="https://irys-reflex-backend.onrender.com",a=await fetch(`${n}/api/irys/upload`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:JSON.stringify(e),tags:[{name:"App",value:"IrysReflex"},{name:"Tool",value:"ReactionTime"},{name:"Content-Type",value:"application/json"},{name:"Player",value:e.player},{name:"Username",value:e.username},{name:"GameMode",value:e.game_mode||"classic"},{name:"Timestamp",value:e.timestamp}],player_address:e.player})}),t=await a.json();if(a.ok&&t.success)return console.log("Score uploaded to Irys:",t.tx_id),t.tx_id;if(402===a.status)throw new Error("Insufficient balance. Please fund your account with IRYS tokens at https://irys.xyz/faucet");throw new Error(t.detail||t.error||"Upload failed")}catch(n){throw console.error("Error uploading score to Irys:",n),n}}(e);E(n),r.Ay.success("\u2705 Uploaded to Irys!",{id:"upload"}),r.Ay.loading("Saving score...",{id:"save"});const a=await fetch("https://irys-reflex-backend.onrender.com/api/scores",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({player:g,username:y.trim(),time:c,penalty:h,timestamp:(new Date).toISOString(),tx_id:n,game_mode:M,hits_count:"endurance"===M?G:null,accuracy:"precision"===M?Z/(Z+Q)*100:null,sequence_times:"sequence"===M?W:null,total_targets:"sequence"===M?L:"precision"===M?Z+Q:null})});if(!a.ok)throw new Error("Failed to save score to backend");{const e=await a.json();r.Ay.success("\ud83c\udf89 Score saved! "+(e.verified?"Verified on Irys":"Pending verification"),{id:"save"}),je(),await ce()}}catch(e){console.error("Error uploading to Irys:",e),e.message.includes("insufficient balance")||e.message.includes("Insufficient balance")?r.Ay.error("\ud83d\udcb8 Insufficient IRYS balance! Please fund your account.",{id:"upload",duration:6e3,action:{label:"Get Tokens",onClick:()=>{var e;null!==S&&void 0!==S&&null!==(e=S.config)&&void 0!==e&&e.faucet_url&&window.open(S.config.faucet_url,"_blank")}}}):e.message.includes("rejected")?r.Ay.error("Transaction was rejected by user",{id:"upload"}):r.Ay.error("\u274c Failed to upload: "+e.message,{id:"upload"})}finally{C(!1)}}},disabled:I,className:"save-btn",children:I?"Saving to Irys...":"Save to Irys"})]})]})]}),(0,u.jsxs)("div",{className:"leaderboard-section",children:[(0,u.jsxs)("h2",{className:"leaderboard-title",children:["\ud83c\udfc6 Leaderboard - ",ke(M)]}),(0,u.jsx)("div",{className:"leaderboard",children:Array.isArray(T)&&0!==T.length?(0,u.jsx)("div",{className:"leaderboard-list",children:T.map((e,n)=>(0,u.jsxs)("div",{className:"leaderboard-entry",children:[(0,u.jsxs)("div",{className:"rank",children:["#",n+1]}),(0,u.jsxs)("div",{className:"player-info",children:[(0,u.jsx)("div",{className:"username",children:e.username}),(0,u.jsxs)("div",{className:"address",children:[e.player.slice(0,6),"...",e.player.slice(-4)]})]}),(0,u.jsxs)("div",{className:"time",children:["endurance"===e.game_mode?`${e.time} hits`:"precision"===e.game_mode?`${e.time}ms (${e.accuracy?e.accuracy.toFixed(1):"0"}%)`:`${e.time}ms`,e.penalty&&" (penalty)"]}),(0,u.jsx)("div",{className:"verified",children:e.verified?"\u2705":"\u23f3"})]},e.id))}):(0,u.jsxs)("p",{className:"no-scores",children:["No scores yet for ",ke(M)," mode. Be the first!"]})})]}),$&&(0,u.jsxs)("div",{className:"tx-info",children:[(0,u.jsxs)("p",{children:["Last transaction: ",$]}),(0,u.jsx)("a",{href:(be=$,`${o[{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_BACKEND_URL:"https://irys-reflex-backend.onrender.com",REACT_APP_IRYS_RPC_URL:"https://testnet-rpc.irys.xyz/v1/execution-rpc",REACT_APP_GATEWAY_URL:"https://gateway.irys.xyz"}.REACT_APP_IRYS_NETWORK||"testnet"].gateway}/${be}`),target:"_blank",rel:"noopener noreferrer",className:"tx-link",children:"View on Irys"})]})]})]});var be};s.createRoot(document.getElementById("root")).render((0,u.jsx)(t.StrictMode,{children:(0,u.jsx)(m,{})}))}},n={};function a(t){var s=n[t];if(void 0!==s)return s.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,a),r.exports}a.m=e,(()=>{var e=[];a.O=(n,t,s,r)=>{if(!t){var c=1/0;for(d=0;d<e.length;d++){t=e[d][0],s=e[d][1],r=e[d][2];for(var o=!0,i=0;i<t.length;i++)(!1&r||c>=r)&&Object.keys(a.O).every(e=>a.O[e](t[i]))?t.splice(i--,1):(o=!1,r<c&&(c=r));if(o){e.splice(d--,1);var l=s();void 0!==l&&(n=l)}}return n}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[t,s,r]}})(),a.d=(e,n)=>{for(var t in n)a.o(n,t)&&!a.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e={792:0};a.O.j=n=>0===e[n];var n=(n,t)=>{var s,r,c=t[0],o=t[1],i=t[2],l=0;if(c.some(n=>0!==e[n])){for(s in o)a.o(o,s)&&(a.m[s]=o[s]);if(i)var d=i(a)}for(n&&n(t);l<c.length;l++)r=c[l],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(d)},t=self.webpackChunkfrontend=self.webpackChunkfrontend||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))})();var t=a.O(void 0,[96],()=>a(306));t=a.O(t)})();